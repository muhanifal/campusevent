<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daftar Acara - CampusEvent</title>
    <link rel="stylesheet" href="assets/css/global.css">
    <link rel="stylesheet" href="assets/css/acara.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo">CampusEvent</div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a class="active" href="acara.html">Acara</a></li>
            <li><a href="login.html">Admin</a></li>
        </ul>
    </nav>

    <section class="event-page">
        <h1 class="page-title">Daftar Acara Kampus</h1>

        <div class="search-container">
            <input type="text" id="searchEvent" placeholder="Cari acara..." class="search-input">
        </div>

        <div class="filter-container">
            <button class="filter-btn active">Semua</button>
            <button class="filter-btn">Seminar</button>
            <button class="filter-btn">Workshop</button>
            <button class="filter-btn">Konser</button>
            <button class="filter-btn">Kompetisi</button>
        </div>

        <div class="event-list" id="eventList">
            <!-- Event cards akan di-generate oleh JavaScript -->
        </div>
    </section>

    <script>
        // Ambil data acara dari localStorage
        let events = JSON.parse(localStorage.getItem("campusEvents")) || [];
        
        // Jika tidak ada data, gunakan data default
        if (events.length === 0) {
            events = [
                {
                    id: "seminar-teknologi",
                    title: "Seminar Teknologi",
                    formatted_date: "12 Januari 2026",
                    location: "Aula Kampus",
                    price: 20000,
                    price_formatted: "Rp 20.000",
                    category: "seminar",
                    image: "img/card/seminarteknologi.png"
                },
                {
                    id: "workshop-uiux",
                    title: "Workshop UI/UX",
                    formatted_date: "20 Januari 2026",
                    location: "Lab Informatika",
                    price: 30000,
                    price_formatted: "Rp 30.000",
                    category: "workshop",
                    image: "img/card/workshop.png"
                },
                {
                    id: "konser-musik",
                    title: "Konser Musik Kampus",
                    formatted_date: "5 Februari 2026",
                    location: "Lapangan Utama",
                    price: 50000,
                    price_formatted: "Rp 50.000",
                    category: "konser",
                    image: "img/card/konser.png"
                },
                {
                    id: "festival-budaya",
                    title: "Festival Budaya Nusantara",
                    formatted_date: "17 Februari 2026",
                    location: "Lapangan Barat Kampus",
                    price: 15000,
                    price_formatted: "Rp 15.000",
                    category: "konser",
                    image: "img/card/festival.png"
                },
                {
                    id: "turnamen-esport",
                    title: "Turnamen E-Sport Kampus",
                    formatted_date: "25 Februari 2026",
                    location: "Auditorium",
                    price: 35000,
                    price_formatted: "Rp 35.000",
                    category: "kompetisi",
                    image: "img/card/turnamen.png"
                },
                {
                    id: "seminar-karir",
                    title: "Seminar Karir & CV Building",
                    formatted_date: "3 Maret 2026",
                    location: "Ruang Seminar Lantai 2",
                    price: 10000,
                    price_formatted: "Rp 10.000",
                    category: "seminar",
                    image: "img/card/seminarkarir.png"
                }
            ];
        }

        // Fungsi untuk menampilkan event cards
        function displayEvents(eventList) {
            const eventListContainer = document.getElementById("eventList");
            eventListContainer.innerHTML = "";
            
            eventList.forEach(event => {
                const eventCard = document.createElement("div");
                eventCard.className = "event-card";
                eventCard.setAttribute("data-category", event.category);
                
                // Cek ketersediaan tiket
                const ticketsAvailable = event.tickets || 20; // default 20 jika tidak ada data
                const ticketStatus = ticketsAvailable > 0 ? 
                    `<p><strong>Tiket Tersedia:</strong> ${ticketsAvailable}</p>` : 
                    `<p style="color:red;"><strong>Status:</strong> TIKET HABIS</p>`;
                
                eventCard.innerHTML = `
                    <img src="${event.image}" alt="Poster ${event.title}" class="event-img" onerror="this.src='img/default-event.jpg'">
                    <h3>${event.title}</h3>
                    <p><strong>Tanggal:</strong> ${event.formatted_date}</p>
                    <p><strong>Lokasi:</strong> ${event.location}</p>
                    <p><strong>Harga:</strong> ${event.price_formatted}</p>
                    ${ticketStatus}
                    <a href="detail.html?id=${event.id}" class="btn-primary">Lihat Detail</a>
                `;
                
                // Nonaktifkan tombol jika tiket habis
                if (ticketsAvailable <= 0) {
                    const btn = eventCard.querySelector(".btn-primary");
                    btn.textContent = "Tiket Habis";
                    btn.style.backgroundColor = "#ccc";
                    btn.style.cursor = "not-allowed";
                    btn.href = "#";
                    btn.onclick = (e) => e.preventDefault();
                }
                
                eventListContainer.appendChild(eventCard);
            });
        }

        // Tampilkan semua event awal
        displayEvents(events);

        const filterButtons = document.querySelectorAll('.filter-btn');
        const searchInput = document.getElementById("searchEvent");

        let currentFilter = 'semua';

        function updateDisplay() {
            const query = searchInput.value.toLowerCase();

            const filteredEvents = events.filter(event => {
                const category = event.category.toLowerCase();
                const title = event.title.toLowerCase();

                return (currentFilter === 'semua' || category === currentFilter) && 
                       title.includes(query);
            });

            displayEvents(filteredEvents);
        }

        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                currentFilter = btn.textContent.toLowerCase();

                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                updateDisplay();
            });
        });

        searchInput.addEventListener("input", () => {
            updateDisplay();
        });
    </script>

</body>
</html>